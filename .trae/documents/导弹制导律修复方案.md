## 问题分析

导弹未命中目标的主要原因是**制导律实现有误**，特别是PN、APN和OGL制导律。具体问题如下：

1. **PN制导律公式错误**：直接使用视线速率向量作为制导指令，而没有将其转换为垂直于视线的加速度
2. **坐标系不匹配**：制导指令应该在垂直于视线的方向上，而不是直接使用视线速率
3. **APN和OGL制导律存在相同问题**

## 修复方案

1. **修复PN制导律**：将视线速率转换为垂直于视线的加速度
2. **修复APN制导律**：使用相同的方法修复，同时考虑目标加速度
3. **修复OGL制导律**：使用相同的方法修复，同时考虑时间到拦截
4. **确保坐标系一致性**：制导指令始终垂直于视线方向

## 具体修改

### 文件：`guidance/GuidanceLaw.m`

1. **修改 `calculate_PN` 方法**（第35-70行）
   - 添加视线向量获取
   - 使用 `cross(los_rate, los_vector)` 将视线速率转换为垂直于视线的加速度

2. **修改 `calculate_APN` 方法**（第99-143行）
   - 同样使用 `cross(los_rate, los_vector)` 计算基础制导指令
   - 保持目标加速度补偿项

3. **修改 `calculate_OGL` 方法**（第145-200行）
   - 同样使用 `cross(los_rate, los_vector)` 计算基础制导指令
   - 保持目标加速度和时间到拦截补偿项

## 技术原理

PN制导律的正确公式是：
```
a_m = N * Vc * cross(los_rate, los_vector)
```
其中：
- `a_m` 是导弹加速度
- `N` 是导航比
- `Vc` 是接近速度
- `cross(los_rate, los_vector)` 产生垂直于视线的向量

这个公式确保导弹加速度始终垂直于视线，这是正确命中目标的关键。