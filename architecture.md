# 寻的导弹制导律验证程序架构

## 系统架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                         主程序 (main.m)                          │
│                    - 参数配置与初始化                            │
│                    - 模块集成与调用                              │
│                    - 结果输出                                    │
└─────────────────────────────────────────────────────────────────┘
                                │
                ┌───────────────┼───────────────┐
                │               │               │
                ▼               ▼               ▼
┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐
│  导弹运动学模型   │  │  目标运动学模型   │  │    制导律模块     │
│  MissileModel    │  │   TargetModel    │  │  GuidanceLaw     │
│                  │  │                  │  │                  │
│ - 状态更新        │  │ - 状态更新        │  │ - 比例导引(PN)   │
│ - 运动方程        │  │ - 运动方程        │  │ - 纯追踪(PP)     │
│ - 约束条件        │  │ - 机动模型        │  │ - 扩展比例导引   │
│ - 传感器模型      │  │ - 干扰模型        │  │ - 自适应制导     │
└──────────────────┘  └──────────────────┘  └──────────────────┘
                │               │               │
                └───────────────┼───────────────┘
                                ▼
                    ┌──────────────────────┐
                    │   仿真环境模块        │
                    │   SimulationEnv      │
                    │                      │
                    │ - 仿真循环控制        │
                    │ - 时间步长管理        │
                    │ - 相对运动计算        │
                    │ - 碰撞检测            │
                    └──────────────────────┘
                                │
                ┌───────────────┼───────────────┐
                ▼               ▼               ▼
┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐
│  数据记录模块     │  │   可视化模块      │  │   分析模块       │
│  DataLogger      │  │   Visualizer     │  │   Analyzer       │
│                  │  │                  │  │                  │
│ - 状态记录        │  │ - 轨迹绘制        │  │ - 性能指标计算   │
│ - 数据存储        │  │ - 视线角绘制      │  │ - 误差分析       │
│ - 文件导出        │  │ - 控制量绘制      │  │ - 参数敏感性分析 │
│                  │  │ - 动画演示        │  │ - 对比分析       │
└──────────────────┘  └──────────────────┘  └──────────────────┘
                                │
                                ▼
                    ┌──────────────────────┐
                    │   测试模块           │
                    │   Tests/             │
                    │                      │
                    │ - 单元测试            │
                    │ - 集成测试            │
                    │ - 性能测试            │
                    └──────────────────────┘
```

## 模块详细说明

### 1. 主程序 (main.m)
**功能**: 程序入口，负责参数配置、模块集成和结果输出

**主要职责**:
- 加载仿真参数
- 初始化各模块
- 调用仿真循环
- 调用可视化和分析
- 输出最终结果

---

### 2. 导弹运动学模型 (MissileModel.m)
**功能**: 描述导弹的运动状态和动力学特性

**输入**:
- 导弹初始状态 (位置、速度、姿态角)
- 制导指令 (加速度指令)
- 时间步长

**输出**:
- 导弹当前状态
- 导弹加速度

**状态变量**:
- 位置: [x, y, z]
- 速度: [Vx, Vy, Vz]
- 姿态角: [θ, φ, γ]
- 加速度: [ax, ay, az]

---

### 3. 目标运动学模型 (TargetModel.m)
**功能**: 描述目标的运动状态和机动特性

**输入**:
- 目标初始状态
- 机动指令
- 时间步长

**输出**:
- 目标当前状态

**运动模式**:
- 匀速直线运动
- 圆弧机动
- 正弦机动
- 随机机动

---

### 4. 制导律模块 (GuidanceLaw.m)
**功能**: 根据相对运动状态计算制导指令

**支持的制导律**:
- 比例导引 (Proportional Navigation, PN)
- 纯追踪 (Pure Pursuit, PP)
- 扩展比例导引 (Augmented Proportional Navigation, APN)
- 最优制导律 (Optimal Guidance, OGL)

**输入**:
- 导弹状态
- 目标状态
- 相对运动参数

**输出**:
- 制导加速度指令

---

### 5. 仿真环境模块 (SimulationEnv.m)
**功能**: 管理仿真过程，协调各模块交互

**主要功能**:
- 仿真循环控制
- 时间步长管理
- 相对运动计算 (相对位置、相对速度、视线角等)
- 碰撞检测
- 仿真终止条件判断

---

### 6. 数据记录模块 (DataLogger.m)
**功能**: 记录和存储仿真数据

**记录内容**:
- 导弹状态历史
- 目标状态历史
- 制导指令历史
- 相对运动参数历史
- 仿真时间

**输出格式**:
- MAT文件
- CSV文件

---

### 7. 可视化模块 (Visualizer.m)
**功能**: 绘制仿真结果

**可视化内容**:
- 三维轨迹图 (导弹和目标)
- 二维平面投影
- 视线角变化曲线
- 制导加速度曲线
- 相对距离变化曲线
- 动画演示

---

### 8. 分析模块 (Analyzer.m)
**功能**: 分析仿真结果，计算性能指标

**性能指标**:
- 脱靶量 (Miss Distance)
- 拦截时间 (Interception Time)
- 能量消耗 (Energy Consumption)
- 控制量峰值
- 收敛特性

**分析功能**:
- 参数敏感性分析
- 制导律对比
- 误差分析

---

### 9. 测试模块 (Tests/)
**功能**: 对各模块进行单元测试和集成测试

**测试内容**:
- `test_MissileModel.m` - 导弹模型测试
- `test_TargetModel.m` - 目标模型测试
- `test_GuidanceLaw.m` - 制导律测试
- `test_SimulationEnv.m` - 仿真环境测试
- `test_DataLogger.m` - 数据记录测试
- `test_Visualizer.m` - 可视化测试
- `test_Analyzer.m` - 分析模块测试
- `test_Integration.m` - 集成测试

---

## 数据流图

```
参数配置
    │
    ▼
┌─────────────┐
│   main.m    │
└─────────────┘
    │
    ├─────────────────────────────────┐
    │                                 │
    ▼                                 ▼
┌─────────────┐                  ┌─────────────┐
│ MissileModel│                  │ TargetModel │
└─────────────┘                  └─────────────┘
    │                                 │
    └─────────────┬───────────────────┘
                  │
                  ▼
          ┌─────────────┐
          │GuidanceLaw  │
          └─────────────┘
                  │
                  ▼
          ┌─────────────┐
          │SimulationEnv│◄─────────┐
          └─────────────┘          │
                  │                │
                  ▼                │
          ┌─────────────┐          │
          │ DataLogger  │          │
          └─────────────┘          │
                  │                │
                  ▼                │
          ┌─────────────┐          │
          │ Visualizer  │          │
          └─────────────┘          │
                  │                │
                  ▼                │
          ┌─────────────┐          │
          │  Analyzer   │          │
          └─────────────┘          │
                                   │
                                   └─反馈循环 (未达到终止条件)
```

## 文件结构

```
GuidanceLawVerification/
├── main.m                          # 主程序入口
├── config.m                        # 仿真参数配置
├── models/                         # 模型目录
│   ├── MissileModel.m             # 导弹运动学模型
│   └── TargetModel.m              # 目标运动学模型
├── guidance/                       # 制导律目录
│   └── GuidanceLaw.m              # 制导律实现
├── simulation/                     # 仿真环境目录
│   └── SimulationEnv.m            # 仿真环境
├── utils/                          # 工具函数目录
│   ├── DataLogger.m               # 数据记录
│   ├── Visualizer.m               # 可视化
│   └── Analyzer.m                 # 分析工具
├── tests/                          # 测试目录
│   ├── test_MissileModel.m
│   ├── test_TargetModel.m
│   ├── test_GuidanceLaw.m
│   ├── test_SimulationEnv.m
│   ├── test_DataLogger.m
│   ├── test_Visualizer.m
│   ├── test_Analyzer.m
│   └── test_Integration.m
├── results/                        # 结果目录
│   ├── data/                      # 仿真数据
│   └── figures/                   # 图形输出
└── README.md                       # 本文档
```

## 仿真流程

1. **初始化阶段**
   - 加载配置参数
   - 初始化导弹和目标状态
   - 初始化数据记录器

2. **仿真循环**
   ```
   while 未满足终止条件:
       a. 更新目标状态
       b. 计算相对运动参数
       c. 制导律计算
       d. 更新导弹状态
       e. 记录数据
       f. 判断终止条件
   ```

3. **终止条件**
   - 相对距离 < 脱靶量阈值
   - 仿真时间 > 最大时间
   - 导弹速度 < 最小速度

4. **后处理阶段**
   - 数据分析
   - 结果可视化
   - 报告生成

## 扩展性设计

### 添加新的制导律
1. 在 `GuidanceLaw.m` 中添加新方法
2. 在配置文件中添加参数
3. 编写对应的测试用例

### 添加新的目标运动模型
1. 在 `TargetModel.m` 中添加新运动模式
2. 更新配置文件
3. 编写测试用例

### 添加新的分析指标
1. 在 `Analyzer.m` 中添加新计算方法
2. 更新可视化模块
3. 编写测试用例
